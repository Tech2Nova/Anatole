<!doctype html>
<html
  dir="ltr"
  lang="zh"
  data-theme=""
  
    class="html theme--light"
  
><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8" />
  <title>
    
      
        LXCè¿è¡Œè„šæœ¬ |
      Chenxi Dang

  </title>

  <meta name="generator" content="Hugo 0.152.2"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="author" content="Chenxi Dang" />
  <meta
    name="description"
    content="Call me Chenxi"
  />
  

  
        <link rel="stylesheet" href="/css/anatole.ltr.css" />
      
  <link
    rel="stylesheet"
    href="/css/markupHighlight.min.73ccfdf28df555e11009c13c20ced067af3cb021504cba43644c705930428b00.css"
    integrity="sha256-c8z98o31VeEQCcE8IM7QZ688sCFQTLpDZExwWTBCiwA="
    crossorigin="anonymous"
    type="text/css"
  />
  
    
    
    <link
      rel="stylesheet"
      href="/css/chroma-github.min.a968f0f04450fa39b333459807fbe64fe349f702243723da32a2274d98e47edd.css"
      integrity="sha256-qWjw8ERQ&#43;jmzM0WYB/vmT&#43;NJ9wIkNyPaMqInTZjkft0="
      crossorigin="anonymous"
      media="screen"
    />
  
    
    
    <link
      rel="stylesheet"
      href="/css/custom.min.9b7b3c8a7f827c4963b69adb800358a8486e53cfdc9af178bed1fd613ab8213c.css"
      integrity="sha256-m3s8in&#43;CfEljtprbgANYqEhuU8/cmvF4vtH9YTq4ITw="
      crossorigin="anonymous"
      media="screen"
    />
  
  
  <link
    rel="stylesheet"
    href="/fontawesome/css/fontawesome.min.10cb17328b3207590ce3d89fb482e7cd6937d8138cef2059c69cabd65ab7d6c6.css"
    integrity="sha256-EMsXMosyB1kM49iftILnzWk32BOM7yBZxpyr1lq31sY="
    crossorigin="anonymous"
    type="text/css"
  />
  
  <link
    rel="stylesheet"
    href="/fontawesome/css/solid.min.7aa4d559d5fadcfed666b5679be54d0dbbcf6a0542742319765b253d2797cc44.css"
    integrity="sha256-eqTVWdX63P7WZrVnm&#43;VNDbvPagVCdCMZdlslPSeXzEQ="
    crossorigin="anonymous"
    type="text/css"
  />
  
  <link
    rel="stylesheet"
    href="/fontawesome/css/regular.min.a699c3ab02229020e2d51dfe6c9a4cc556fd7781edbc166e2af9d0db9d5c66ce.css"
    integrity="sha256-ppnDqwIikCDi1R3&#43;bJpMxVb9d4HtvBZuKvnQ251cZs4="
    crossorigin="anonymous"
    type="text/css"
  />
  
  <link
    rel="stylesheet"
    href="/fontawesome/css/brands.min.1d88b60c86c4bb253fa4d4c085d27f7ee1f6eca544f7b50b227a2e63fbcfbaaa.css"
    integrity="sha256-HYi2DIbEuyU/pNTAhdJ/fuH27KVE97ULInouY/vPuqo="
    crossorigin="anonymous"
    type="text/css"
  />
  
  <link rel="shortcut icon" href="/favicons/favicon.ico" type="image/x-icon" />
  <link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png" />

  <link rel="canonical" href="http://localhost:1313/post/setup_lxc/" />
  
  
  
  
  <script
    type="text/javascript"
    src="/js/anatole-header.min.f9132794301a01ff16550ed66763482bd848f62243d278f5e550229a158bfd32.js"
    integrity="sha256-&#43;RMnlDAaAf8WVQ7WZ2NIK9hI9iJD0nj15VAimhWL/TI="
    crossorigin="anonymous"
  ></script>

  
    
    
    <script
      type="text/javascript"
      src="/js/anatole-theme-switcher.min.8724ddf9268dee451060f191961647573c7f592fbccc6d858746236b3f915813.js"
      integrity="sha256-hyTd&#43;SaN7kUQYPGRlhZHVzx/WS&#43;8zG2Fh0Yjaz&#43;RWBM="
      crossorigin="anonymous"
    ></script>
  

  

  

  


  
  
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="http://localhost:1313/images/site-feature-image.png">
  <meta name="twitter:title" content="LXCè¿è¡Œè„šæœ¬">
  <meta name="twitter:description" content="åœ¨ Ubuntu ä¸»æœºä¸­åˆ©ç”¨ LXC å®¹å™¨é‡‡é›†HPCæ•°æ®">



  
  <meta property="og:url" content="http://localhost:1313/post/setup_lxc/">
  <meta property="og:site_name" content="æˆ‘çš„åšå®¢">
  <meta property="og:title" content="LXCè¿è¡Œè„šæœ¬">
  <meta property="og:description" content="åœ¨ Ubuntu ä¸»æœºä¸­åˆ©ç”¨ LXC å®¹å™¨é‡‡é›†HPCæ•°æ®">
  <meta property="og:locale" content="zh">
  <meta property="og:type" content="article">
    <meta property="article:section" content="post">
    <meta property="article:published_time" content="2026-01-31T00:00:00+00:00">
    <meta property="article:modified_time" content="2026-01-31T00:00:00+00:00">
    <meta property="og:image" content="http://localhost:1313/images/site-feature-image.png">



  
  
  
  
  <script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "articleSection": "post",
        "name": "LXCè¿è¡Œè„šæœ¬",
        "headline": "LXCè¿è¡Œè„šæœ¬",
        "alternativeHeadline": "",
        "description": "
      
        \u003cp\u003eåœ¨ Ubuntu ä¸»æœºä¸­åˆ©ç”¨ LXC å®¹å™¨é‡‡é›†HPCæ•°æ®\u003c\/p\u003e


      


    ",
        "license": "",
        
        "inLanguage": "zh",
        "isFamilyFriendly": "true",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "http:\/\/localhost:1313\/post\/setup_lxc\/"
        },
        "author" : {
            "@type": "Person",
            "name": "chenxi"
        },
        "creator" : {
            "@type": "Person",
            "name": "chenxi"
        },
        "accountablePerson" : {
            "@type": "Person",
            "name": "chenxi"
        },
        "copyrightHolder" : {
            "@type": "Person",
            "name": "chenxi"
        },
        "dateCreated": "2026-01-31T00:00:00.00Z",
        "datePublished": "2026-01-31T00:00:00.00Z",
        "dateModified": "2026-01-31T00:00:00.00Z",
        "publisher":{
            "@type":"Organization",
            "name": "chenxi",
            "url": "http://localhost:1313/",
            "logo": {
                "@type": "ImageObject",
                "url": "http:\/\/localhost:1313\/favicons\/favicon-32x32.png",
                "width":"32",
                "height":"32"
            }
        },
        "image": 
      [
        
        "http://localhost:1313/images/site-feature-image.png"


      
      ]

    ,
        "url" : "http:\/\/localhost:1313\/post\/setup_lxc\/",
        "wordCount" : "558",
        "genre" : [ 
      
      "Blog"

    ],
        "keywords" : [ ]
    }
  </script>




  
  
  



<style>
  .welcome-text {
      font-size: 2rem;
      color: #878787;           
      text-align: center;
      margin: 20px 0;
      font-weight: bold;
       
  }
</style>
</head>
<body class="body">
    <div class="wrapper">
      <aside
        
          class="wrapper__sidebar"
        
      >
<div
  class="sidebar
    animated fadeInDown
  "
>
  <div class="sidebar__content">
    <div class="sidebar__introduction">
      <img
        class="sidebar__introduction-profileimage"
        src="/images/profile.jpg"
        alt="profile picture"
      />
      
        <div class="sidebar__introduction-title">
          <a href="/">I&#39;m Chenxi Dang</a>
        </div>
      
      <div class="sidebar__introduction-description">
        <p>Call me Chenxi</p>
      </div>
    </div>
    <ul class="sidebar__list">
      
        <li class="sidebar__list-item">
          <a
            href="https://github.com/Tech2Nova/"
            target="_blank"
            rel="noopener me"
            aria-label="GitHub"
            title="GitHub"
          >
            <i class="fa-brands fa-github fa-2x" aria-hidden="true"></i>
          </a>
        </li>
      
        <li class="sidebar__list-item">
          <a
            href="mailto:Dangchenxi650@163.com"
            target="_blank"
            rel="noopener me"
            aria-label="e-mail"
            title="e-mail"
          >
            <i class="fa-solid fa-envelope fa-2x" aria-hidden="true"></i>
          </a>
        </li>
      
        <li class="sidebar__list-item">
          <a
            href="https://weixin.qq.com/"
            target="_blank"
            rel="noopener me"
            aria-label="WeChat"
            title="WeChat"
          >
            <i class="fa-brands fa-weixin fa-2x" aria-hidden="true"></i>
          </a>
        </li>
      
        <li class="sidebar__list-item">
          <a
            href="https://www.bilibili.com/"
            target="_blank"
            rel="noopener me"
            aria-label="Bilibili"
            title="Bilibili"
          >
            <i class="fa-brands fa-bilibili fa-2x" aria-hidden="true"></i>
          </a>
        </li>
      
    </ul>
  
  </div>

  
    <div class="welcome-text">
    ğŸ‘‹ èŠ±å¾„ä¸æ›¾ç¼˜å®¢æ‰«ï¼Œè“¬é—¨ä»Šå§‹ä¸ºå›å¼€ã€‚
    </div>
  <footer class="footer footer__sidebar">
  <ul class="footer__list">
    <li class="footer__item">
      &copy;
      
        Chenxi Dang
        2026
      
    </li>
    
      <li class="footer__item">
        <a
          class="link"
          href="/imprint/"
          
          title=""
        >
          æ³•å¾‹å£°æ˜
        </a>
      </li>
    
  </ul>
</footer>
  
  <script
    type="text/javascript"
    src="/js/medium-zoom.min.9531b4a2217a70c5a1fce89c1f81c9ebbdd586708fcd4130b417320c7230c8d6.js"
    integrity="sha256-lTG0oiF6cMWh/OicH4HJ673VhnCPzUEwtBcyDHIwyNY="
    crossorigin="anonymous"
  ></script></div>

</aside>
      <main
        
          class="wrapper__main"
        
      >
        <header class="header"><div
  class="
    animated fadeInDown
  "
>
  <a role="button" class="navbar-burger" data-target="navMenu" aria-label="menu" aria-expanded="false">
    <span aria-hidden="true" class="navbar-burger__line"></span>
    <span aria-hidden="true" class="navbar-burger__line"></span>
    <span aria-hidden="true" class="navbar-burger__line"></span>
  </a>
  <nav class="nav">
    <ul class="nav__list" id="navMenu">
      
      
        
        
          <li class="nav__list-item">
            
            <a
              
              href="/"
              
              title=""
              >é¦–é¡µ</a
            >
          </li>
        

      
        
        
          <li class="nav__list-item">
            
            <a
              
              href="/post/"
              
              title=""
              >æ–‡ç« </a
            >
          </li>
        

      
        
        
          <li class="nav__list-item">
            
            <a
              
              href="/categories/"
              
              title=""
              >ä¸“é¢˜</a
            >
          </li>
        

      
        
        
          <li class="nav__list-item">
            
            <a
              
              href="/about/"
              
              title=""
              >å…³äºæˆ‘</a
            >
          </li>
        

      
        
        
          <li class="nav__list-item">
            
            <a
              
              href="/work/"
              
              title=""
              >å·¥ä½œç»å†</a
            >
          </li>
        

      
    </ul>
    <ul class="nav__list nav__list--end">
      
        <li class="nav__list-item">
          <div class="optionswitch">
            <input class="optionswitch__picker" type="checkbox" id="languagepicker" hidden />
            <label class="optionswitch__label" for="languagepicker"
              >ä¸­æ–‡ï¼ˆç®€ä½“ï¼‰ <i class="fa fa-angle-down" aria-hidden="true"></i
            ></label>
            <div class="optionswitch__triangle"></div>
            <ul class="optionswitch__list">
              
                <li class="optionswitch__list-item">
                  <a href="/en/post/setup-lxc/" title="English"
                    ><span
                      
                      aria-label="English"
                      >English</span
                    >
                  </a>
                </li>
              
            </ul>
          </div>
        </li>
      
      
        <li class="nav__list-item">
          <div class="themeswitch">
            <a title="Switch Theme">
              <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a>
          </div>
        </li>
      
    </ul>
  </nav>
</div>
</header>
  <div
    class="post 
      animated fadeInDown
    "
  >
    
    <div class="post__content">
      
        <h1>LXCè¿è¡Œè„šæœ¬</h1>
      
      
        <ul class="post__meta">
          <li class="post__meta-item">
            <em class="fas fa-calendar-day post__meta-icon"></em>
            <span class="post__meta-text"
              >
                
                  2026å¹´01æœˆ31æ—¥
                

              
            </span>
          </li>
          <li class="post__meta-item">
            <em class="fas fa-stopwatch post__meta-icon"></em>
            <span class="post__meta-text"></span>
          </li>
        </ul>
      <p>åœ¨ Ubuntu ä¸»æœºä¸­åˆ©ç”¨ LXC å®¹å™¨é‡‡é›†HPCæ•°æ®</p>
<p>æ­¤è„šæœ¬å†ç»ä¸€ä¸ªæœˆï¼Œç»ˆäºå¯ä»¥æ­£å¸¸è¿è¡Œï¼Œä¹‹å‰ç‰ˆæœ¬ä¼šé‡åˆ°å„ç§å„æ ·çš„é—®é¢˜ï¼Œå¯¼è‡´ç³»ç»Ÿæ­»æœºï¼Œæ— æ³•å®ç°è¿ç»­è¿è¡Œï¼Œæ”¶é›†æ•°æ®éå¸¸è€—æ—¶ï¼Œä¹‹å‰ç”šè‡³è¿˜å†¤æ‰äº†å®éªŒå®¤çš„ç”µè„‘ï¼Œåæ¥æœ‰ä¸€å¤©æ™šä¸Šçªç„¶æƒ³èµ·æ¥ä¼šä¸ä¼šæ˜¯è„šæœ¬ä¸­perfå‘½ä»¤çš„é—®é¢˜ï¼Œè®©AIæ›´æ–°äº†ä¸€ç‰ˆï¼Œæœç„¶æ­£å¸¸äº†èµ·æ¥ï¼ŒåŸæ¥æ˜¯æˆ‘å¤ªè ¢äº†ğŸ˜­ğŸ˜­</p>
<p>ç›®å‰ç‰ˆæœ¬é…åˆğŸ‘‰ <a href="/post/lxc_command/">Linux LXCå®¹å™¨ä½¿ç”¨</a>
è¿™ç¯‡åšå®¢ä¸€èµ·ä½¿ç”¨ï¼Œé¦–å…ˆåœ¨ubuntuä¸­é…ç½®LXCå®¹å™¨ï¼Œå°†å®éªŒæ ·æœ¬æ”¾å…¥å®¹å™¨ä¸­å¹¶æ‹æ‘„å¿«ç…§</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#!/bin/bash</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ç”¨é€”ï¼šåœ¨ LXC å®¹å™¨ ubuntu22 ä¸­ä¾æ¬¡è¿è¡Œ /home/1 ç›®å½•ä¸‹æ‰€æœ‰æ ·æœ¬</span>
</span></span><span class="line"><span class="cl"><span class="c1"># æ”¯æŒï¼š--start N æˆ– -s N ä»ç¬¬ N ä¸ªæ ·æœ¬ç»§ç»­</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">set</span> -u
</span></span><span class="line"><span class="cl"><span class="nb">set</span> -e
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#ç›¸å…³é…ç½®ä¿¡æ¯ï¼Œæ ¹æ®è‡ªå·±lxcå®¹å™¨çš„åå­—åšç›¸åº”ä¿®æ”¹</span>
</span></span><span class="line"><span class="cl"><span class="nv">CONTAINER</span><span class="o">=</span><span class="s2">&#34;lxc1&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">SNAPSHOT</span><span class="o">=</span><span class="s2">&#34;snap0&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">CGROUP</span><span class="o">=</span><span class="s2">&#34;/lxc.payload.lxc1&#34;</span>           
</span></span><span class="line"><span class="cl"><span class="nv">CONTAINER_SAMPLES_DIR</span><span class="o">=</span><span class="s2">&#34;/home/1&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">OUTPUT_DIR</span><span class="o">=</span><span class="s2">&#34;./results4&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">LOG_FILE</span><span class="o">=</span><span class="s2">&#34;./run_lxc_log4.txt&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#åœ¨æ”¶é›†å®Œhpcæ•°æ®åï¼Œå¯èƒ½ä¼šå‡ºç°æ²¡æœ‰æƒé™å†™å…¥HOSTä¸»æœºçš„æƒ…å†µï¼Œæˆ‘çŒœæ˜¯ç”±äºhpcæ˜¯åœ¨rootæƒé™ä¸‹é‡‡é›†çš„ï¼Œç§»åŠ¨hpcæ•°æ®ä¹Ÿéœ€è¦rootæƒé™ï¼Œä»¥ä¸‹ä¸‰è¡Œè§£å†³è¿™ä¸ªé—®é¢˜</span>
</span></span><span class="line"><span class="cl">mkdir -p <span class="s2">&#34;</span><span class="nv">$OUTPUT_DIR</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">chmod <span class="m">755</span> <span class="s2">&#34;</span><span class="nv">$OUTPUT_DIR</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">chown -R <span class="s2">&#34;</span><span class="k">$(</span>whoami<span class="k">)</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="nv">$OUTPUT_DIR</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">exec</span> 1&gt;&gt;<span class="s2">&#34;</span><span class="nv">$LOG_FILE</span><span class="s2">&#34;</span> 2&gt;<span class="p">&amp;</span><span class="m">1</span>   <span class="c1"># æŠŠæ‰€æœ‰è¾“å‡ºåŒæ—¶è®°å½•åˆ°æ—¥å¿—æ–‡ä»¶ï¼Œä¾¿äºæ’æŸ¥</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;è„šæœ¬å¯åŠ¨äº </span><span class="k">$(</span>date<span class="k">)</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;å½“å‰å†…æ ¸: </span><span class="k">$(</span>uname -r<span class="k">)</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;perf ç‰ˆæœ¬: </span><span class="k">$(</span>perf version 2&gt;/dev/null <span class="o">||</span> <span class="nb">echo</span> <span class="s1">&#39;perf æœªæ‰¾åˆ°&#39;</span><span class="k">)</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># =============== å‚æ•°è§£æ ===============</span>
</span></span><span class="line"><span class="cl"><span class="nv">START_INDEX</span><span class="o">=</span><span class="m">1</span>
</span></span><span class="line"><span class="cl"><span class="k">while</span> <span class="o">[[</span> <span class="nv">$#</span> -gt <span class="m">0</span> <span class="o">]]</span><span class="p">;</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="nv">$1</span> in
</span></span><span class="line"><span class="cl">        --start<span class="p">|</span>-s<span class="o">)</span>
</span></span><span class="line"><span class="cl">            <span class="nv">START_INDEX</span><span class="o">=</span><span class="s2">&#34;</span><span class="nv">$2</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> ! <span class="o">[[</span> <span class="s2">&#34;</span><span class="nv">$START_INDEX</span><span class="s2">&#34;</span> <span class="o">=</span>~ ^<span class="o">[</span>0-9<span class="o">]</span>+$ <span class="o">]]</span> <span class="o">||</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$START_INDEX</span><span class="s2">&#34;</span> -lt <span class="m">1</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">                <span class="nb">echo</span> <span class="s2">&#34;é”™è¯¯ï¼š--start å‚æ•°å¿…é¡»æ˜¯æ­£æ•´æ•° â‰¥1&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="nb">exit</span> <span class="m">1</span>
</span></span><span class="line"><span class="cl">            <span class="k">fi</span>
</span></span><span class="line"><span class="cl">            <span class="nb">shift</span> <span class="m">2</span>
</span></span><span class="line"><span class="cl">            <span class="p">;;</span>
</span></span><span class="line"><span class="cl">        *<span class="o">)</span>
</span></span><span class="line"><span class="cl">            <span class="nb">echo</span> <span class="s2">&#34;æœªçŸ¥å‚æ•°: </span><span class="nv">$1</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="nb">echo</span> <span class="s2">&#34;ç”¨æ³•: </span><span class="nv">$0</span><span class="s2"> [--start N | -s N]&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="nb">exit</span> <span class="m">1</span>
</span></span><span class="line"><span class="cl">            <span class="p">;;</span>
</span></span><span class="line"><span class="cl">    <span class="k">esac</span>
</span></span><span class="line"><span class="cl"><span class="k">done</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;è¿è¡Œæ¨¡å¼ï¼šä»ç¬¬ </span><span class="nv">$START_INDEX</span><span class="s2"> ä¸ªæ ·æœ¬å¼€å§‹&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># =============== å•æ¬¡è¿è¡Œå‡½æ•° ===============</span>
</span></span><span class="line"><span class="cl">run_experiment<span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="nb">local</span> <span class="nv">sample_index</span><span class="o">=</span><span class="s2">&#34;</span><span class="nv">$1</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nb">local</span> <span class="nv">sample_filename</span><span class="o">=</span><span class="s2">&#34;</span><span class="nv">$2</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nb">local</span> <span class="nv">output_file</span><span class="o">=</span><span class="s2">&#34;</span><span class="nv">$OUTPUT_DIR</span><span class="s2">/</span><span class="k">$(</span><span class="nb">printf</span> <span class="s2">&#34;%04d&#34;</span> <span class="nv">$sample_index</span><span class="k">)</span><span class="s2">.csv&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="o">[</span> -f <span class="s2">&#34;</span><span class="nv">$output_file</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">        <span class="nb">echo</span> <span class="s2">&#34;è·³è¿‡ï¼šç¬¬ </span><span class="nv">$sample_index</span><span class="s2"> (</span><span class="nv">$sample_filename</span><span class="s2">) â†’ å·²å­˜åœ¨ </span><span class="nv">$output_file</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="m">0</span>
</span></span><span class="line"><span class="cl">    <span class="k">fi</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;================================================================&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;å¼€å§‹ ç¬¬ </span><span class="nv">$sample_index</span><span class="s2">  â†’ </span><span class="nv">$sample_filename</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;è¾“å‡º â†’ </span><span class="nv">$output_file</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;================================================================&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># 1. æ¢å¤å¿«ç…§</span>
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;æ¢å¤å¿«ç…§ </span><span class="nv">$SNAPSHOT</span><span class="s2"> ...&#34;</span>
</span></span><span class="line"><span class="cl">    sudo lxc-snapshot -n <span class="s2">&#34;</span><span class="nv">$CONTAINER</span><span class="s2">&#34;</span> -r <span class="s2">&#34;</span><span class="nv">$SNAPSHOT</span><span class="s2">&#34;</span> <span class="o">||</span> <span class="o">{</span> <span class="nb">echo</span> <span class="s2">&#34;å¿«ç…§æ¢å¤å¤±è´¥&#34;</span><span class="p">;</span> <span class="k">return</span> 1<span class="p">;</span> <span class="o">}</span>
</span></span><span class="line"><span class="cl">    sleep <span class="m">6</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># 2. å¯åŠ¨å®¹å™¨ï¼ˆå‰å° &amp; æ•è· PIDï¼‰</span>
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;å¯åŠ¨å®¹å™¨...&#34;</span>
</span></span><span class="line"><span class="cl">    sudo lxc-start -n <span class="s2">&#34;</span><span class="nv">$CONTAINER</span><span class="s2">&#34;</span> -F <span class="p">&amp;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">LXC_PID</span><span class="o">=</span><span class="nv">$!</span>
</span></span><span class="line"><span class="cl">    sleep <span class="m">4</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># 3. è¿è¡Œç¨‹åº + perf å‰å°é‡‡é›†ï¼ˆæœ€å…³é”®ï¼šperf ä¸èƒ½åœ¨åå°è¿è¡Œï¼‰</span>
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;å¯åŠ¨ perf + æ ·æœ¬ç¨‹åº...&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    sudo perf stat -x <span class="s1">&#39;,&#39;</span> -I <span class="m">100</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>        -e dTLB-load-misses,dTLB-store-misses,iTLB-load-misses,bus-cycles <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>        --cgroup<span class="o">=</span><span class="s2">&#34;</span><span class="nv">$CGROUP</span><span class="s2">&#34;</span> -a <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>        -- bash -c <span class="s2">&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">            set -e
</span></span></span><span class="line"><span class="cl"><span class="s2">            timeout 7.5 \
</span></span></span><span class="line"><span class="cl"><span class="s2">            bash -c &#39;
</span></span></span><span class="line"><span class="cl"><span class="s2">                sudo lxc-attach -n \&#34;</span><span class="nv">$CONTAINER</span><span class="s2">\&#34; --nice 19 -- \&#34;</span><span class="nv">$CONTAINER_SAMPLES_DIR</span><span class="s2">/</span><span class="nv">$sample_filename</span><span class="s2">\&#34; &amp;
</span></span></span><span class="line"><span class="cl"><span class="s2">                PROG_PID=\$!
</span></span></span><span class="line"><span class="cl"><span class="s2">                sleep 7.2
</span></span></span><span class="line"><span class="cl"><span class="s2">                pkill -9 -u user 2&gt;/dev/null || true
</span></span></span><span class="line"><span class="cl"><span class="s2">                killall -9 -u user 2&gt;/dev/null || true
</span></span></span><span class="line"><span class="cl"><span class="s2">                wait \$PROG_PID 2&gt;/dev/null || true
</span></span></span><span class="line"><span class="cl"><span class="s2">            &#39;
</span></span></span><span class="line"><span class="cl"><span class="s2">        &#34;</span> &gt; <span class="s2">&#34;</span><span class="nv">$output_file</span><span class="s2">&#34;</span> 2&gt;<span class="p">&amp;</span><span class="m">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nv">PERF_EXIT</span><span class="o">=</span><span class="nv">$?</span>
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;perf é€€å‡ºç : </span><span class="nv">$PERF_EXIT</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># 4. å¼ºåˆ¶æ¸…ç†å®¹å™¨ï¼ˆå¤šé‡ä¿é™©ï¼‰</span>
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;å¼ºåˆ¶åœæ­¢å®¹å™¨...&#34;</span>
</span></span><span class="line"><span class="cl">    sudo lxc-stop -n <span class="s2">&#34;</span><span class="nv">$CONTAINER</span><span class="s2">&#34;</span> -k <span class="o">||</span> <span class="nb">true</span>
</span></span><span class="line"><span class="cl">    sleep 1.5
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># ç­‰å¾…çŠ¶æ€å˜ä¸º STOPPEDï¼Œæœ€å¤šç­‰ 10 ç§’</span>
</span></span><span class="line"><span class="cl">    sudo lxc-wait -n <span class="s2">&#34;</span><span class="nv">$CONTAINER</span><span class="s2">&#34;</span> -s STOPPED -t <span class="m">10</span> <span class="o">||</span> <span class="nb">true</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># å†æš´åŠ›æ€ä¸€æ¬¡æ®‹ç•™</span>
</span></span><span class="line"><span class="cl">    sudo pkill -9 -f <span class="s2">&#34;lxc.*</span><span class="nv">$CONTAINER</span><span class="s2">&#34;</span> 2&gt;/dev/null <span class="o">||</span> <span class="nb">true</span>
</span></span><span class="line"><span class="cl">    sudo killall -9 -q -u <span class="s2">&#34;</span><span class="k">$(</span>sudo lxc-info -n <span class="s2">&#34;</span><span class="nv">$CONTAINER</span><span class="s2">&#34;</span> -pH 2&gt;/dev/null<span class="k">)</span><span class="s2">&#34;</span> 2&gt;/dev/null <span class="o">||</span> <span class="nb">true</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># ç­‰å¾… lxc-start è¿›ç¨‹ç»“æŸ</span>
</span></span><span class="line"><span class="cl">    <span class="nb">wait</span> <span class="nv">$LXC_PID</span> 2&gt;/dev/null <span class="o">||</span> <span class="nb">true</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;âœ“ ç¬¬ </span><span class="nv">$sample_index</span><span class="s2"> å®Œæˆï¼Œç»“æœ: </span><span class="nv">$output_file</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span>
</span></span><span class="line"><span class="cl">    sleep <span class="m">2</span>   <span class="c1"># æ¯è½®ä¹‹é—´å¤šç•™ä¸€ç‚¹å–˜æ¯æ—¶é—´ï¼Œå‡è½»å­˜å‚¨/å†…æ ¸å‹åŠ›</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># =============== è·å–æ ·æœ¬åˆ—è¡¨ ===============</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;è·å–æ ·æœ¬åˆ—è¡¨ï¼ˆåŸºäºå¿«ç…§ </span><span class="nv">$SNAPSHOT</span><span class="s2">ï¼‰...&#34;</span>
</span></span><span class="line"><span class="cl">sudo lxc-snapshot -n <span class="s2">&#34;</span><span class="nv">$CONTAINER</span><span class="s2">&#34;</span> -r <span class="s2">&#34;</span><span class="nv">$SNAPSHOT</span><span class="s2">&#34;</span> &gt;/dev/null 2&gt;<span class="p">&amp;</span><span class="m">1</span> <span class="o">||</span> <span class="nb">true</span>
</span></span><span class="line"><span class="cl">sudo lxc-start -n <span class="s2">&#34;</span><span class="nv">$CONTAINER</span><span class="s2">&#34;</span> -d
</span></span><span class="line"><span class="cl">sleep <span class="m">4</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">mapfile -t sample_files &lt; &lt;<span class="o">(</span>
</span></span><span class="line"><span class="cl">    sudo lxc-attach -n <span class="s2">&#34;</span><span class="nv">$CONTAINER</span><span class="s2">&#34;</span> -- ls -1 <span class="s2">&#34;</span><span class="nv">$CONTAINER_SAMPLES_DIR</span><span class="s2">&#34;</span> 2&gt;/dev/null <span class="p">|</span>
</span></span><span class="line"><span class="cl">    grep -v <span class="s1">&#39;^$&#39;</span> <span class="p">|</span> sort -V
</span></span><span class="line"><span class="cl"><span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">sudo lxc-stop -n <span class="s2">&#34;</span><span class="nv">$CONTAINER</span><span class="s2">&#34;</span> -k &gt;/dev/null 2&gt;<span class="p">&amp;</span><span class="m">1</span> <span class="o">||</span> <span class="nb">true</span>
</span></span><span class="line"><span class="cl">sleep <span class="m">2</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">total_samples</span><span class="o">=</span><span class="si">${#</span><span class="nv">sample_files</span><span class="p">[@]</span><span class="si">}</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;å‘ç° </span><span class="nv">$total_samples</span><span class="s2"> ä¸ªæ ·æœ¬&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="o">[</span> <span class="nv">$total_samples</span> -eq <span class="m">0</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;é”™è¯¯ï¼šæ²¡æœ‰æ ·æœ¬æ–‡ä»¶ï¼&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nb">exit</span> <span class="m">1</span>
</span></span><span class="line"><span class="cl"><span class="k">fi</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="o">[</span> <span class="nv">$START_INDEX</span> -gt <span class="nv">$total_samples</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;é”™è¯¯ï¼šSTART_INDEX=</span><span class="nv">$START_INDEX</span><span class="s2"> &gt; æ€»æ ·æœ¬ </span><span class="nv">$total_samples</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nb">exit</span> <span class="m">1</span>
</span></span><span class="line"><span class="cl"><span class="k">fi</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;å‰5ä¸ªæ ·æœ¬é¢„è§ˆï¼š&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">printf</span> <span class="s2">&#34;  %s\n&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">sample_files</span><span class="p">[@]:</span><span class="nv">0</span><span class="p">:</span><span class="nv">5</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span> <span class="nv">$total_samples</span> -gt <span class="m">5</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s2">&#34;  ...&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># =============== ä¸»å¾ªç¯ ===============</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;å¼€å§‹æ‰¹é‡è¿è¡Œï¼ˆä»ç¬¬ </span><span class="nv">$START_INDEX</span><span class="s2"> ä¸ªï¼‰...&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="o">((</span><span class="nv">i</span> <span class="o">=</span> START_INDEX - 1<span class="p">;</span> i &lt; total_samples<span class="p">;</span> i++<span class="o">))</span><span class="p">;</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">    <span class="nv">index</span><span class="o">=</span><span class="k">$((</span>i <span class="o">+</span> <span class="m">1</span><span class="k">))</span>
</span></span><span class="line"><span class="cl">    <span class="nv">filename</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">sample_files</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    run_experiment <span class="s2">&#34;</span><span class="nv">$index</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="nv">$filename</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">done</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># =============== æ€»ç»“ ===============</span>
</span></span><span class="line"><span class="cl"><span class="nv">completed_count</span><span class="o">=</span><span class="k">$(</span>ls -1 <span class="s2">&#34;</span><span class="nv">$OUTPUT_DIR</span><span class="s2">&#34;</span>/*.csv 2&gt;/dev/null <span class="p">|</span> wc -l<span class="k">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;======================================================================&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;æœ¬æ¬¡è¿è¡Œç»“æŸ </span><span class="k">$(</span>date<span class="k">)</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;æ€»æ ·æœ¬æ•°     : </span><span class="nv">$total_samples</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;èµ·å§‹ä½ç½®     : ç¬¬ </span><span class="nv">$START_INDEX</span><span class="s2"> ä¸ª&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;å·²ç”Ÿæˆç»“æœ   : </span><span class="nv">$completed_count</span><span class="s2"> ä¸ª&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;ç»“æœç›®å½•     : </span><span class="nv">$OUTPUT_DIR</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;æœ€è¿‘10ä¸ªç»“æœæ–‡ä»¶ï¼š&#34;</span>
</span></span><span class="line"><span class="cl">ls -1 <span class="s2">&#34;</span><span class="nv">$OUTPUT_DIR</span><span class="s2">&#34;</span>/*.csv 2&gt;/dev/null <span class="p">|</span> sort -V <span class="p">|</span> tail -10 <span class="o">||</span> <span class="nb">true</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;======================================================================&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;æ—¥å¿—æ–‡ä»¶ï¼š</span><span class="nv">$LOG_FILE</span><span class="s2">&#34;</span>
</span></span></code></pre></div>
</div>
    <div class="post__footer">
      
        <span><a class="category" href="/categories/blog/">Blog</a></span>


      

      
    </div>

    
  </div>

      </main>
    </div><footer class="footer footer__base">
  <ul class="footer__list">
    <li class="footer__item">
      &copy;
      
        Chenxi Dang
        2026
      
    </li>
    
      <li class="footer__item">
        <a
          class="link"
          href="/imprint/"
          
          title=""
        >
          æ³•å¾‹å£°æ˜
        </a>
      </li>
    
  </ul>
</footer>
  
  <script
    type="text/javascript"
    src="/js/medium-zoom.min.9531b4a2217a70c5a1fce89c1f81c9ebbdd586708fcd4130b417320c7230c8d6.js"
    integrity="sha256-lTG0oiF6cMWh/OicH4HJ673VhnCPzUEwtBcyDHIwyNY="
    crossorigin="anonymous"
  ></script>
  <script async defer src=" https://scripts.simpleanalyticscdn.com/latest.js"></script>
  <noscript><img src="https://queue.simpleanalyticscdn.com/noscript.gif" alt="" /></noscript>

</body>
</html>
